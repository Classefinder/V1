<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Classefinder | Lycée Lachenal changement</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet-search@4.0.0/dist/leaflet-search.min.css" />
  <link rel="stylesheet" href="LyceeLachenal.css" />  
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.js"></script>
  <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
  <script src="https://unpkg.com/leaflet-search@4.0.0/dist/leaflet-search.min.js"></script>  
  <style>
    /* Style personnalisé pour les labels */
    .room-label {
      font-weight: bold;
      color: black;
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid gray;
      border-radius: 3px;
      padding: 2px 4px;
    }
  </style>
</head>
<body>
  <div id="map" style="height: 100  vh;"></div>

  <script>

    //test
    // --- 1. Initialisation de la carte avec les limites définies ---
    var sudOuest = L.latLng(45.93818505744445, 6.134245788738398);
    var nordEst   = L.latLng(45.93640970079779, 6.13115811037474);
    var limites   = L.latLngBounds(sudOuest, nordEst);

    // Fond de carte par défaut (celui que vous aviez mis)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map = L.map('map', {
      center: [45.9368, 6.1322],
      zoom: 18,
      minZoom: 10,
      maxZoom: 23,
      maxBounds: limites,
      maxBoundsViscosity: 1.0
    }));

    // Créez un pane pour les fonds personnalisés
    map.createPane('floorPane');
    map.getPane('floorPane').style.zIndex = 450;

    // --- 2. Données GeoJSON pour les salles et les chemins ---
    var salleEtage0 = {
        "type": "FeatureCollection",
"features": [
{ "type": "Feature", "properties": { "name": "13" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132443855592967, 45.936792791783532 ], [ 6.132451800410498, 45.936862076107261 ], [ 6.132332645198166, 45.936867696926917 ], [ 6.132323764318674, 45.936798784599809 ], [ 6.132443855592967, 45.936792791783532 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "14" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132323764318674, 45.93679878003244 ], [ 6.132332645193752, 45.936867696937178 ], [ 6.132169440848435, 45.936875476859768 ], [ 6.132160492656691, 45.936806544549889 ], [ 6.132323764318674, 45.93679878003244 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "12" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132338097023253, 45.936716667911078 ], [ 6.132346542802771, 45.936781465154866 ], [ 6.132227172282988, 45.936787083013414 ], [ 6.132219251901891, 45.936722066542458 ], [ 6.132338097023253, 45.936716667911078 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "11" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132219253543763, 45.936722064258774 ], [ 6.132227180492344, 45.936787079587916 ], [ 6.132107560408311, 45.936792893842551 ], [ 6.132099429867845, 45.936727498286743 ], [ 6.132219253543763, 45.936722064258774 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "10" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132099431509721, 45.936727500570427 ], [ 6.132116122760606, 45.936862250362864 ], [ 6.132020322927197, 45.936866941039654 ], [ 6.132004120953585, 45.936731824727232 ], [ 6.132099431509721, 45.936727500570427 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "9" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132116189227633, 45.936862186893528 ], [ 6.132124696936733, 45.936927733982991 ], [ 6.132030014367759, 45.936932969021719 ], [ 6.132034131001193, 45.936967051293124 ], [ 6.131986299641299, 45.936969668810697 ], [ 6.131974067359097, 45.936869957663198 ], [ 6.132020328027306, 45.936866941377744 ], [ 6.132116189227633, 45.936862186893528 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "8" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132034162856094, 45.936967030843746 ], [ 6.132129805972868, 45.936962027567596 ], [ 6.132146782185027, 45.937094102999801 ], [ 6.132050178520454, 45.937099556148802 ], [ 6.132034162856094, 45.936967030843746 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "15" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132291844506018, 45.93705440405904 ], [ 6.132305228465431, 45.937189553478937 ], [ 6.132287198591141, 45.937205146048541 ], [ 6.13226320449913, 45.937221778117973 ], [ 6.132204944334536, 45.937188404911318 ], [ 6.132189418745586, 45.937059001748601 ], [ 6.132291844506018, 45.93705440405904 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132429212643101, 45.936677276337036 ], [ 6.132434054588134, 45.936712841350747 ], [ 6.132395279821793, 45.936744510723749 ], [ 6.132342136044464, 45.936747360012134 ], [ 6.132338097823097, 45.936716658581339 ], [ 6.132385145062337, 45.936678840720951 ], [ 6.132429212643101, 45.936677276337036 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132322925088437, 45.936918998692519 ], [ 6.132327943460623, 45.936952494757485 ], [ 6.132285071663862, 45.936986031700897 ], [ 6.132229085449164, 45.936950899707192 ], [ 6.132270918286057, 45.936921370819881 ], [ 6.132322925088437, 45.936918998692519 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "7.8" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132146752780492, 45.937094072325785 ], [ 6.132155613343883, 45.937160109923944 ], [ 6.132058539206915, 45.937165017752214 ], [ 6.132050227527985, 45.937099552740484 ], [ 6.132146752780492, 45.937094072325785 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "7" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132155652549918, 45.93716013718965 ], [ 6.132172550350009, 45.937297392623044 ], [ 6.132127541824469, 45.937332483498757 ], [ 6.132076181921632, 45.937303309267982 ], [ 6.132058534306163, 45.937165019456316 ], [ 6.132155652549918, 45.93716013718965 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132124809654063, 45.936927665818267 ], [ 6.132129592790053, 45.936961966219414 ], [ 6.132034184909476, 45.936967024027155 ], [ 6.132030019268502, 45.936932969021555 ], [ 6.132124809654063, 45.936927665818267 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132127490366544, 45.937332306272104 ], [ 6.132086245620142, 45.93736513407989 ], [ 6.132037159667203, 45.937368187828461 ], [ 6.132032611767408, 45.937336232522568 ], [ 6.132076130463709, 45.937303254736648 ], [ 6.132127490366544, 45.937332306272104 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132138673887373, 45.937393728884139 ], [ 6.132143378611296, 45.937427101967195 ], [ 6.132192150915976, 45.937424484471208 ], [ 6.132237002617387, 45.937389093732136 ], [ 6.132232297893465, 45.93738816670168 ], [ 6.132208441757645, 45.93737396577297 ], [ 6.132179048994928, 45.937358162623937 ], [ 6.132138673887373, 45.937393728884139 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "6" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132343015729806, 45.937316239997791 ], [ 6.132350691535879, 45.937382440072874 ], [ 6.13223712023548, 45.937388848341719 ], [ 6.132236983014368, 45.937389039200923 ], [ 6.132232337099492, 45.93738816670168 ], [ 6.132208441022562, 45.937374084016618 ], [ 6.132231729405984, 45.937355952383939 ], [ 6.132203501062438, 45.937339702073515 ], [ 6.132224358671837, 45.937322579258051 ], [ 6.132343015729806, 45.937316239997791 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Vie scolaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132400060507383, 45.937214102827369 ], [ 6.132407744889787, 45.93727924051597 ], [ 6.132272680107135, 45.937286629508058 ], [ 6.13233688121087, 45.937233275714483 ], [ 6.132359597431251, 45.93721620484137 ], [ 6.132400060507383, 45.937214102827369 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Vie scolaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132343015729793, 45.93731622892107 ], [ 6.132555370305162, 45.937303652644516 ], [ 6.132492072165367, 45.937357025115475 ], [ 6.13246746057834, 45.937375797489615 ], [ 6.1323507001122, 45.937382440072881 ], [ 6.132343015729793, 45.93731622892107 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132680458377678, 45.937160127816881 ], [ 6.132684692629208, 45.937194319011482 ], [ 6.132642644159137, 45.937228169363955 ], [ 6.13259702794009, 45.937201523971432 ], [ 6.132645770840243, 45.937162152296104 ], [ 6.132680458377678, 45.937160127816881 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132695542898757, 45.937253478725957 ], [ 6.13274682438953, 45.937282925639479 ], [ 6.132787441839407, 45.937250643096419 ], [ 6.132783834884398, 45.937219560224705 ], [ 6.132734572504311, 45.937222835514987 ], [ 6.132695542898757, 45.937253478725957 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Secrétariat proviseur adjoint" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132615381264143, 45.937431161982602 ], [ 6.132622359937963, 45.937493545595771 ], [ 6.132528637916793, 45.937499584914747 ], [ 6.13252459969542, 45.937463348991074 ], [ 6.132581409236804, 45.937459831733115 ], [ 6.132578939256744, 45.937433520455258 ], [ 6.132615381264143, 45.937431161982602 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132579331317066, 45.937317014512168 ], [ 6.132604815238322, 45.93733151982898 ], [ 6.132613205329322, 45.937411626190674 ], [ 6.132519581323232, 45.937417733682537 ], [ 6.132517459296714, 45.937399871311889 ], [ 6.132596861314435, 45.937337661411675 ], [ 6.132570946126824, 45.93732327197543 ], [ 6.132579331317066, 45.937317014512168 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Proviseur adjoint" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132613122016498, 45.937411646639852 ], [ 6.132615395966392, 45.937431155166159 ], [ 6.132578944157489, 45.93743352045523 ], [ 6.132581411687172, 45.937459825768734 ], [ 6.132524582542757, 45.937463348138976 ], [ 6.132519534766045, 45.937417773728832 ], [ 6.132613122016498, 45.937411646639852 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "CDI" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132622357487582, 45.93749354474366 ], [ 6.132647576768123, 45.937722189765296 ], [ 6.132555050530928, 45.937728678939031 ], [ 6.132558432051241, 45.937762051820499 ], [ 6.132515922910283, 45.937764996485562 ], [ 6.132511727864784, 45.937730410294073 ], [ 6.132550933897492, 45.937699279976741 ], [ 6.13252862566488, 45.937499587470832 ], [ 6.132622357487582, 45.93749354474366 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Intendance" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132752805759918, 45.937354016524857 ], [ 6.132759509991513, 45.937433850198289 ], [ 6.132697133193469, 45.937437531051373 ], [ 6.132695094479769, 45.937423053027864 ], [ 6.132672198156667, 45.937424361775903 ], [ 6.132665297894908, 45.937358542617325 ], [ 6.132752805759918, 45.937354016524857 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Réunion" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13268693962496, 45.937734152474675 ], [ 6.132724371584688, 45.937755917101136 ], [ 6.132730076062447, 45.937817775490217 ], [ 6.132523666101738, 45.937830593630423 ], [ 6.132515893505752, 45.93776498285284 ], [ 6.132659858057863, 45.937755058240391 ], [ 6.13268693962496, 45.937734152474675 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "2" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132732036364085, 45.937583762966582 ], [ 6.13278055627994, 45.937611251701604 ], [ 6.132786978718173, 45.937680022046131 ], [ 6.132836143083193, 45.93770783280651 ], [ 6.132840181304563, 45.937738206503354 ], [ 6.132791781457181, 45.937742078194205 ], [ 6.132705567391249, 45.937690246591977 ], [ 6.132696706827857, 45.937614066863524 ], [ 6.132732036364085, 45.937583762966582 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "1" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132780578333331, 45.937611251701561 ], [ 6.132823636358756, 45.937608586499657 ], [ 6.132819754961515, 45.937578267262815 ], [ 6.132732060867852, 45.937583761262459 ], [ 6.132780578333331, 45.937611251701561 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132759514279655, 45.937433845511926 ], [ 6.132760651254606, 45.937446578535969 ], [ 6.132728815956053, 45.937474662069 ], [ 6.132699019371199, 45.937458248199967 ], [ 6.132697137481632, 45.937437529773213 ], [ 6.132759514279655, 45.937433845511926 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Secrétariat proviseur" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132760876689291, 45.937446506963816 ], [ 6.132827526944882, 45.937442962439214 ], [ 6.132832937377396, 45.937493676385046 ], [ 6.132767894569147, 45.937497548092971 ], [ 6.132728825757555, 45.937474651844404 ], [ 6.132760876689291, 45.937446506963816 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Proviseur" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132896157105121, 45.937439158891394 ], [ 6.132901802773832, 45.937489872840708 ], [ 6.132832942278148, 45.937493669568639 ], [ 6.132827551448652, 45.937442969255599 ], [ 6.132896157105121, 45.937439158891394 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13289620121191, 45.937439206606143 ], [ 6.132947639526813, 45.937436534579568 ], [ 6.132953049959326, 45.937481250109293 ], [ 6.13290114117203, 45.937483758540381 ], [ 6.13289620121191, 45.937439206606143 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Acceuil" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13286554209434, 45.937540852582487 ], [ 6.132914000750758, 45.937569045129827 ], [ 6.132917607705767, 45.937602908886312 ], [ 6.132823513227285, 45.937608525578206 ], [ 6.132819759249651, 45.937578254055992 ], [ 6.13286554209434, 45.937540852582487 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132676921871012, 45.937470814216766 ], [ 6.132691349691046, 45.937470050781037 ], [ 6.132795480913898, 45.937530689356478 ], [ 6.132774623304502, 45.937547266797218 ], [ 6.1327354172718, 45.937549666163221 ], [ 6.132681940243197, 45.93751880158343 ], [ 6.132676921871012, 45.937470814216766 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132533074937031, 45.937322475733509 ], [ 6.132581788432659, 45.937349455071761 ], [ 6.132538436362003, 45.93738344165758 ], [ 6.132492075228335, 45.937357041730223 ], [ 6.132533074937031, 45.937322475733509 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13255515773495, 45.937728684477079 ], [ 6.132558451041697, 45.937762111889391 ], [ 6.132631923146978, 45.93775698599061 ], [ 6.132629021900557, 45.937723394982591 ], [ 6.13255515773495, 45.937728684477079 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132203538430669, 45.937339741693542 ], [ 6.132179015057211, 45.93735817325333 ], [ 6.132208419581737, 45.937373987308597 ], [ 6.132231707965161, 45.937355937472724 ], [ 6.132203538430669, 45.937339741693542 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132109463555203, 45.937346721693224 ], [ 6.132161450754563, 45.937376713869369 ], [ 6.132138476019402, 45.937393727605723 ], [ 6.132086175171779, 45.937365098719432 ], [ 6.132109463555203, 45.937346721693224 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132287223707468, 45.937205158402804 ], [ 6.132336936956933, 45.937233187526743 ], [ 6.132294516029551, 45.937268414771381 ], [ 6.132240725352684, 45.93723885878746 ], [ 6.132263249218473, 45.937221735940867 ], [ 6.132287223707468, 45.937205158402804 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.133321263216929, 45.937318801689194 ], [ 6.133325654292591, 45.937364607938399 ], [ 6.133278607053349, 45.937398635413302 ], [ 6.133215250104506, 45.937403434158085 ], [ 6.133212231239987, 45.937350702473893 ], [ 6.133252299805406, 45.937320737549292 ], [ 6.133321263216929, 45.937318801689194 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Salle des professeurs" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.133212231239984, 45.937350702473871 ], [ 6.133214740426077, 45.937402616190241 ], [ 6.13322101339131, 45.937454093608906 ], [ 6.133180866413824, 45.937491174770706 ], [ 6.133110721920537, 45.937495412859505 ], [ 6.133104448955305, 45.937431284251304 ], [ 6.133027918779474, 45.937434337996237 ], [ 6.133023414986497, 45.937360299971317 ], [ 6.133212231239984, 45.937350702473871 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.133331260755263, 45.937414449457016 ], [ 6.13328389986776, 45.937417503202859 ], [ 6.133290172832993, 45.937483594946983 ], [ 6.133336592775709, 45.937480977453667 ], [ 6.133331260755263, 45.937414449457016 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132220627360129, 45.937257247778014 ], [ 6.132243053210834, 45.937271971235731 ], [ 6.13225183536216, 45.937265754665177 ], [ 6.132227684446018, 45.937251576519195 ], [ 6.132220627360129, 45.937257247778014 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13281075656434, 45.937507327903141 ], [ 6.132811540684995, 45.937512671949321 ], [ 6.132903753273905, 45.937506782592266 ], [ 6.132903145580401, 45.937501043195077 ], [ 6.13281075656434, 45.937507327903141 ] ] ] ] } }
]
    };

    var salleEtage1 = {
        "type": "FeatureCollection",
        "features": [
          { "type": "Feature", "properties": { "salle": "117" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132443855592967, 45.936792791783532 ], [ 6.132451800410498, 45.936862076107261 ], [ 6.132332645198166, 45.936867696926917 ], [ 6.132323764318674, 45.936798784599809 ], [ 6.132443855592967, 45.936792791783532 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "115" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132323764318674, 45.93679878003244 ], [ 6.132332645193752, 45.936867696937178 ], [ 6.132169440848435, 45.936875476859768 ], [ 6.132160492656691, 45.936806544549889 ], [ 6.132323764318674, 45.93679878003244 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "124" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132338097023253, 45.936716667911078 ], [ 6.132346542802771, 45.936781465154866 ], [ 6.132207412442507, 45.936788228181904 ], [ 6.132199492061409, 45.936723211710948 ], [ 6.132338097023253, 45.936716667911078 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132199509140655, 45.936723205849191 ], [ 6.132207436089236, 45.936788221178332 ], [ 6.132136377516463, 45.936791117445097 ], [ 6.132132754879041, 45.936762889056567 ], [ 6.132103938445006, 45.93676472132563 ], [ 6.132099429867845, 45.936727498286743 ], [ 6.132199509140655, 45.936723205849191 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "122" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132099431509721, 45.936727500570427 ], [ 6.132112398126723, 45.936828289304607 ], [ 6.132015574908368, 45.936832526421732 ], [ 6.132004120953585, 45.936731824727232 ], [ 6.132099431509721, 45.936727500570427 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Labo" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13211617513789, 45.936862304327711 ], [ 6.132124696936733, 45.936927733982991 ], [ 6.132030014367759, 45.936932969021719 ], [ 6.132034131001193, 45.936967051293124 ], [ 6.131986299641299, 45.936969668810697 ], [ 6.131974067359097, 45.936869957663198 ], [ 6.132020328027306, 45.936866941377744 ], [ 6.13211617513789, 45.936862304327711 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "120" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.131986362248373, 45.936969663548616 ], [ 6.132129805972868, 45.936962027567596 ], [ 6.132144150234986, 45.937063098109341 ], [ 6.132045021701906, 45.937069052951351 ], [ 6.132037161504946, 45.93699663215223 ], [ 6.131986362248373, 45.936969663548616 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "111" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132295426222099, 45.937085214045744 ], [ 6.132305228465431, 45.937189553478937 ], [ 6.132208041644729, 45.937194570921683 ], [ 6.132192839716935, 45.937089851949729 ], [ 6.132295426222099, 45.937085214045744 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132429212643101, 45.936677276337036 ], [ 6.132434054588134, 45.936712841350747 ], [ 6.132395279821793, 45.936744510723749 ], [ 6.132342136044464, 45.936747360012134 ], [ 6.132338097823097, 45.936716658581339 ], [ 6.132385145062337, 45.936678840720951 ], [ 6.132429212643101, 45.936677276337036 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132322925088437, 45.936918998692519 ], [ 6.132327943460623, 45.936952494757485 ], [ 6.132285071663862, 45.936986031700897 ], [ 6.132180489816636, 45.936993085724367 ], [ 6.132174150201152, 45.936953463055545 ], [ 6.132205395448914, 45.9369369440588 ], [ 6.132229085449164, 45.936950899707192 ], [ 6.132270918286057, 45.936921370819881 ], [ 6.132322925088437, 45.936918998692519 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "118" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132144150234986, 45.937062983593151 ], [ 6.132155613343883, 45.937160109923944 ], [ 6.132058539206915, 45.937165017752214 ], [ 6.13204506286824, 45.937069038636807 ], [ 6.132144150234986, 45.937062983593151 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "116" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132155652549918, 45.93716013718965 ], [ 6.132171433223073, 45.937275081501866 ], [ 6.132073622012691, 45.937281952447073 ], [ 6.132058534306163, 45.937165019456316 ], [ 6.132155652549918, 45.93716013718965 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132124809654063, 45.936927665818267 ], [ 6.132129592790053, 45.936961966219414 ], [ 6.132034184909476, 45.936967024027155 ], [ 6.132030019268502, 45.936932969021555 ], [ 6.132124809654063, 45.936927665818267 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132127490366544, 45.937332306272104 ], [ 6.132086245620142, 45.93736513407989 ], [ 6.132037159667203, 45.937368187828461 ], [ 6.132032611767408, 45.937336232522568 ], [ 6.132075597996739, 45.93730371043462 ], [ 6.132073663179025, 45.937281923818141 ], [ 6.132171350890403, 45.937275081501859 ], [ 6.132174232533809, 45.937297297554963 ], [ 6.132127490366544, 45.937332306272104 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132138673887373, 45.937393728884139 ], [ 6.132143378611296, 45.937427101967195 ], [ 6.132192150915976, 45.937424484471208 ], [ 6.132237002617387, 45.937389093732136 ], [ 6.132232297893465, 45.93738816670168 ], [ 6.132208441757645, 45.93737396577297 ], [ 6.132179048994928, 45.937358162623937 ], [ 6.132138673887373, 45.937393728884139 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "114" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13236442222366, 45.937315552904067 ], [ 6.132372098029733, 45.937381752979149 ], [ 6.13223712023548, 45.937388848341719 ], [ 6.132236983014368, 45.937389039200923 ], [ 6.132232337099492, 45.93738816670168 ], [ 6.132208441022562, 45.937374084016618 ], [ 6.132231729405984, 45.937355952383939 ], [ 6.132203501062438, 45.937339702073515 ], [ 6.132224358671837, 45.937322579258051 ], [ 6.13236442222366, 45.937315552904067 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132359597431251, 45.93721620484137 ], [ 6.132367426140862, 45.937282553654718 ], [ 6.132272680107135, 45.937286629508058 ], [ 6.13233688121087, 45.937233275714483 ], [ 6.132359597431251, 45.93721620484137 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "112" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132364379832108, 45.937315562808443 ], [ 6.132555370305162, 45.937303652644516 ], [ 6.132492072165367, 45.937357025115475 ], [ 6.13246746057834, 45.937375797489615 ], [ 6.132372242601968, 45.937381609685808 ], [ 6.132364379832108, 45.937315562808443 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132680458377678, 45.937160127816881 ], [ 6.132684692629208, 45.937194319011482 ], [ 6.1326658421573, 45.937209250430143 ], [ 6.132650528280926, 45.93719997464175 ], [ 6.132624675822965, 45.937217381058204 ], [ 6.13259702794009, 45.937201523971432 ], [ 6.132645770840243, 45.937162152296104 ], [ 6.132680458377678, 45.937160127816881 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132695542898757, 45.937253478725957 ], [ 6.13274682438953, 45.937282925639479 ], [ 6.132787441839407, 45.937250643096419 ], [ 6.132783834884398, 45.937219560224705 ], [ 6.132734572504311, 45.937222835514987 ], [ 6.132695542898757, 45.937253478725957 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "108" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132618067367479, 45.93745444152183 ], [ 6.13262565324471, 45.937525609870946 ], [ 6.132531931223539, 45.937531649189921 ], [ 6.13252422870836, 45.937461069099662 ], [ 6.132618067367479, 45.93745444152183 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132579331317066, 45.937317014512168 ], [ 6.132604815238322, 45.93733151982898 ], [ 6.132613394988532, 45.937398228751185 ], [ 6.132558067435183, 45.937367538587011 ], [ 6.132596861314435, 45.937337661411675 ], [ 6.132570946126824, 45.93732327197543 ], [ 6.132579331317066, 45.937317014512168 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "110" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132613065657856, 45.937397999720169 ], [ 6.132617923285308, 45.9374544844651 ], [ 6.132524228708361, 45.937461126357341 ], [ 6.132518094924547, 45.937398973101999 ], [ 6.132558396765859, 45.937367767618177 ], [ 6.132613065657856, 45.937397999720169 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "106" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132625733126997, 45.937525494503866 ], [ 6.132632948997363, 45.937589039885374 ], [ 6.132539007422409, 45.937594994670889 ], [ 6.132532001304295, 45.937531537231038 ], [ 6.132625733126997, 45.937525494503866 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "103" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132753813354941, 45.937366099985113 ], [ 6.132760852798115, 45.937446582902609 ], [ 6.13266761105087, 45.937452995765142 ], [ 6.132658719122656, 45.937372834931978 ], [ 6.132753813354941, 45.937366099985113 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "100" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132681442939215, 45.93773129610107 ], [ 6.132704867842252, 45.937747300759668 ], [ 6.13270778939319, 45.93777824715675 ], [ 6.13252002974229, 45.937790557487965 ], [ 6.132512455136773, 45.937731238843682 ], [ 6.132555226958143, 45.937728662260206 ], [ 6.132558437932219, 45.937762129207364 ], [ 6.132631878672675, 45.937756947414464 ], [ 6.132656084477264, 45.937753741000947 ], [ 6.132681442939215, 45.93773129610107 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132741010624984, 45.937715435796363 ], [ 6.132737717318237, 45.937680852300524 ], [ 6.132785799596741, 45.937678103942311 ], [ 6.132836143083193, 45.93770783280651 ], [ 6.132840181304563, 45.937738206503354 ], [ 6.132791781457181, 45.937742078194205 ], [ 6.132741010624984, 45.937715435796363 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Archives" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132760876689291, 45.937446506963816 ], [ 6.132872809912655, 45.937440557615517 ], [ 6.132879537667867, 45.937505700487861 ], [ 6.132769211891845, 45.937511977019483 ], [ 6.132760876689291, 45.937446506963816 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Video lecture" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.1326675287182, 45.937452881249747 ], [ 6.132760852798117, 45.937446411129493 ], [ 6.132769127231338, 45.937511971161221 ], [ 6.132723062103217, 45.937516179597303 ], [ 6.132671398353628, 45.937486663280488 ], [ 6.1326675287182, 45.937452881249747 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132533074937031, 45.937322475733509 ], [ 6.132581788432659, 45.937349455071761 ], [ 6.132538436362003, 45.93738344165758 ], [ 6.132492075228335, 45.937357041730223 ], [ 6.132533074937031, 45.937322475733509 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13255515773495, 45.937728684477079 ], [ 6.132558451041697, 45.937762111889391 ], [ 6.132631923146978, 45.93775698599061 ], [ 6.132629021900557, 45.937723394982591 ], [ 6.13255515773495, 45.937728684477079 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132203538430669, 45.937339741693542 ], [ 6.132179015057211, 45.93735817325333 ], [ 6.132208419581737, 45.937373987308597 ], [ 6.132231707965161, 45.937355937472724 ], [ 6.132203538430669, 45.937339741693542 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132109463555203, 45.937346721693224 ], [ 6.132159794700891, 45.937375162244294 ], [ 6.132138476019402, 45.937393727605723 ], [ 6.132086175171779, 45.937365098719432 ], [ 6.132109463555203, 45.937346721693224 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132287223707468, 45.937205158402804 ], [ 6.132336936956933, 45.937233187526743 ], [ 6.132294516029551, 45.937268414771381 ], [ 6.132240725352684, 45.93723885878746 ], [ 6.132287223707468, 45.937205158402804 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Germain somelier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.133212231239984, 45.937350702473871 ], [ 6.133217881441951, 45.937418383476846 ], [ 6.13322101339131, 45.937454093608906 ], [ 6.133180866413824, 45.937491174770706 ], [ 6.133110721920537, 45.937495412859505 ], [ 6.133031480280077, 45.937498315213567 ], [ 6.133027918779474, 45.937434337996237 ], [ 6.133023414986497, 45.937360299971317 ], [ 6.133212231239984, 45.937350702473871 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.133331260755263, 45.937414449457016 ], [ 6.13328389986776, 45.937417503202859 ], [ 6.133290172832993, 45.937483594946983 ], [ 6.133336592775709, 45.937480977453667 ], [ 6.133331260755263, 45.937414449457016 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132220627360129, 45.937257247778014 ], [ 6.132243053210834, 45.937271971235731 ], [ 6.13225183536216, 45.937265754665177 ], [ 6.132227684446018, 45.937251576519195 ], [ 6.132220627360129, 45.937257247778014 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132112233461389, 45.936828289304614 ], [ 6.132116185429487, 45.936862300749119 ], [ 6.132020844199165, 45.936866881413451 ], [ 6.132015574908366, 45.936832526421732 ], [ 6.132112233461389, 45.936828289304614 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "113" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132193251380281, 45.937089851949722 ], [ 6.132180407483967, 45.936993085724367 ], [ 6.132285011139517, 45.936986071597914 ], [ 6.132295343889433, 45.937085156787667 ], [ 6.132193251380281, 45.937089851949722 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "109" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132359769202672, 45.937215962708912 ], [ 6.132536537442314, 45.937204854667186 ], [ 6.132544770709182, 45.937271731915743 ], [ 6.132367426140862, 45.937282439138954 ], [ 6.132359769202672, 45.937215962708912 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "107" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132536702107651, 45.937204568377432 ], [ 6.132596969621118, 45.937201361931969 ], [ 6.132619281774327, 45.937214531260366 ], [ 6.132596722623113, 45.937231021545458 ], [ 6.132621587089052, 45.937246080377903 ], [ 6.132598698607162, 45.937268296442632 ], [ 6.132544359045839, 45.937271502884229 ], [ 6.132536702107651, 45.937204568377432 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Laboratoire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132696015821534, 45.937253523905731 ], [ 6.1326509798518, 45.937288093353772 ], [ 6.132746732745435, 45.937282839944096 ], [ 6.132696015821534, 45.937253523905731 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "105" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132746897410771, 45.937282839944096 ], [ 6.132651473847813, 45.937287978838043 ], [ 6.132658719122656, 45.937372605900855 ], [ 6.132753813354941, 45.937366092827908 ], [ 6.132746897410771, 45.937282839944096 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "101" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132778224991227, 45.937582254864495 ], [ 6.132786128927419, 45.93767776039752 ], [ 6.132697209645253, 45.937683486143669 ], [ 6.132685024410289, 45.937587980620499 ], [ 6.132778224991227, 45.937582254864495 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Audio visuel" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132773449696443, 45.937545839042393 ], [ 6.132778224991227, 45.937582140349363 ], [ 6.132685189075628, 45.937587751590279 ], [ 6.132730472043396, 45.937548701922346 ], [ 6.132773449696443, 45.937545839042393 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "Archives" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132773449696443, 45.93754572452719 ], [ 6.132882458149766, 45.937538624584242 ], [ 6.132886739448534, 45.937575040411076 ], [ 6.132778389656563, 45.93758214034937 ], [ 6.132773449696443, 45.93754572452719 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "104" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132539666083759, 45.937594822898255 ], [ 6.132547240689276, 45.937663302885923 ], [ 6.132642746584937, 45.937657348107763 ], [ 6.132632866664695, 45.937589039885381 ], [ 6.132539666083759, 45.937594822898255 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": "102" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132642746584937, 45.937657290850268 ], [ 6.132649580196437, 45.937720846622895 ], [ 6.132629120528272, 45.937723394578015 ], [ 6.132555226958138, 45.937728662260191 ], [ 6.132550657495028, 45.937698888397989 ], [ 6.132547281855611, 45.937663245628464 ], [ 6.132642746584937, 45.937657290850268 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132434137444474, 45.936712875476282 ], [ 6.132395441090198, 45.936744367620776 ], [ 6.132440724057968, 45.936772767793947 ], [ 6.132434137444474, 45.936712875476282 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132305194193759, 45.937189646736634 ], [ 6.132287575002663, 45.937205106385996 ], [ 6.13224130404287, 45.93723877405187 ], [ 6.132221050206378, 45.937256982066735 ], [ 6.132216110246257, 45.937259615930031 ], [ 6.132208206310065, 45.937194685437639 ], [ 6.132305194193759, 45.937189646736634 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132741619087229, 45.93771575908449 ], [ 6.13279118335377, 45.937741868464279 ], [ 6.132704734051663, 45.937747365174232 ], [ 6.132741619087229, 45.93771575908449 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132619241866832, 45.937214403645264 ], [ 6.132642130348722, 45.937228145549867 ], [ 6.13262171184689, 45.937245895504944 ], [ 6.132597012046289, 45.937231122962082 ], [ 6.132619241866832, 45.937214403645264 ] ] ] ] } },
          { "type": "Feature", "properties": { "salle": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132684614005758, 45.937194477877519 ], [ 6.132735001598985, 45.937222992336032 ], [ 6.132715571089178, 45.93723696327018 ], [ 6.132666006822637, 45.937208677850656 ], [ 6.132684614005758, 45.937194477877519 ] ] ] ] } }
        ]
    };

    var salleEtage2 = {
        "type": "FeatureCollection",
"features": [
{ "type": "Feature", "properties": { "name": "V1" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132559263481, 45.937761742137447 ], [ 6.132605358389325, 45.937758765489001 ], [ 6.132614138371865, 45.937824175393722 ], [ 6.132567165465287, 45.937827991605154 ], [ 6.132559263481, 45.937761742137447 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V2" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132607553384967, 45.937773801378285 ], [ 6.132725973399444, 45.93776700851511 ], [ 6.132730253640932, 45.937817306212494 ], [ 6.132614138371868, 45.937824175393722 ], [ 6.132607553384967, 45.937773801378285 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "R12" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132443855592967, 45.936792791783532 ], [ 6.132451800410498, 45.936862076107261 ], [ 6.132332645198166, 45.936867696926917 ], [ 6.132323764318674, 45.936798784599809 ], [ 6.132443855592967, 45.936792791783532 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "R11 " }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132323764318674, 45.93679878003244 ], [ 6.132332645193752, 45.936867696937178 ], [ 6.132169440848435, 45.936875476859768 ], [ 6.132160492656691, 45.936806544549889 ], [ 6.132323764318674, 45.93679878003244 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "R9" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132338097023253, 45.936716667911078 ], [ 6.132346542802771, 45.936781465154866 ], [ 6.132227172282988, 45.936787083013414 ], [ 6.132219251901891, 45.936722066542458 ], [ 6.132338097023253, 45.936716667911078 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "R8" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132219253543763, 45.936722064258774 ], [ 6.132227180492344, 45.936787079587916 ], [ 6.132107560408311, 45.936792893842551 ], [ 6.132099429867845, 45.936727498286743 ], [ 6.132219253543763, 45.936722064258774 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "R7" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132099431509721, 45.936727500570427 ], [ 6.132116122760606, 45.936862250362864 ], [ 6.132020322927197, 45.936866941039654 ], [ 6.132004120953585, 45.936731824727232 ], [ 6.132099431509721, 45.936727500570427 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "R6" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132116189227633, 45.936862186893528 ], [ 6.132124696936733, 45.936927733982991 ], [ 6.132030014367759, 45.936932969021719 ], [ 6.132034131001193, 45.936967051293124 ], [ 6.131986299641299, 45.936969668810697 ], [ 6.131974067359097, 45.936869957663198 ], [ 6.132020328027306, 45.936866941377744 ], [ 6.132116189227633, 45.936862186893528 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "R5" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132038113848223, 45.936998476904492 ], [ 6.132133756964997, 45.936993473628341 ], [ 6.132151611175407, 45.937134784331924 ], [ 6.132055007510834, 45.937140237480925 ], [ 6.132038113848223, 45.936998476904492 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V18" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132302978019801, 45.937163950166401 ], [ 6.132305228465431, 45.937189553478937 ], [ 6.132287198591141, 45.937205146048541 ], [ 6.13226320449913, 45.937221778117973 ], [ 6.132204028302615, 45.937188433835416 ], [ 6.132202875929909, 45.937181011218328 ], [ 6.132226636757653, 45.937179541959814 ], [ 6.132225100260709, 45.93716845573524 ], [ 6.132302978019801, 45.937163950166401 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132429212643101, 45.936677276337036 ], [ 6.132434054588134, 45.936712841350747 ], [ 6.132395279821793, 45.936744510723749 ], [ 6.132342136044464, 45.936747360012134 ], [ 6.132338097823097, 45.936716658581339 ], [ 6.132385145062337, 45.936678840720951 ], [ 6.132429212643101, 45.936677276337036 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132322925088437, 45.936918998692519 ], [ 6.132327943460623, 45.936952494757485 ], [ 6.132285071663862, 45.936986031700897 ], [ 6.132232463785305, 45.936988325741943 ], [ 6.132229085449164, 45.936950899707192 ], [ 6.132270918286057, 45.936921370819881 ], [ 6.132322925088437, 45.936918998692519 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V16" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132517020961398, 45.937206389313879 ], [ 6.132524758321008, 45.937254092469317 ], [ 6.13251274071991, 45.937254970206972 ], [ 6.132515978338468, 45.937274356757314 ], [ 6.132441554267732, 45.937278955337604 ], [ 6.132430647883178, 45.937212151857189 ], [ 6.132517020961398, 45.937206389313879 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "R4" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13215159180801, 45.937134835398332 ], [ 6.132163770367505, 45.937229463372603 ], [ 6.132067401939128, 45.93723538001754 ], [ 6.132055053263787, 45.937140213042852 ], [ 6.13215159180801, 45.937134835398332 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132124809654063, 45.936927665818267 ], [ 6.132129592790053, 45.936961966219414 ], [ 6.132034184909476, 45.936967024027155 ], [ 6.132030019268502, 45.936932969021555 ], [ 6.132124809654063, 45.936927665818267 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Adjoint" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132127490366544, 45.937332306272104 ], [ 6.132086245620142, 45.93736513407989 ], [ 6.132037159667203, 45.937368187828461 ], [ 6.132032611767408, 45.937336232522568 ], [ 6.132076130463709, 45.937303254736648 ], [ 6.132127490366544, 45.937332306272104 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Coordinateur secteurs" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132138673887373, 45.937393728884139 ], [ 6.132143378611296, 45.937427101967195 ], [ 6.132192150915976, 45.937424484471208 ], [ 6.132237002617387, 45.937389093732136 ], [ 6.132232297893465, 45.93738816670168 ], [ 6.132208382213516, 45.937374043118204 ], [ 6.132182092065031, 45.937359878840439 ], [ 6.132138673887373, 45.937393728884139 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132257849899189, 45.9373207431655 ], [ 6.132265525705262, 45.937386943240583 ], [ 6.13223712023548, 45.937388848341719 ], [ 6.132236983014368, 45.937389039200923 ], [ 6.132232337099492, 45.93738816670168 ], [ 6.132208441022562, 45.937374084016618 ], [ 6.132231729405984, 45.937355952383939 ], [ 6.132206212152012, 45.937339523948609 ], [ 6.132226403539401, 45.937323281053075 ], [ 6.132257849899189, 45.9373207431655 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132308071095699, 45.9372562104884 ], [ 6.132359433993545, 45.937284221761089 ], [ 6.132264665057027, 45.937290747546015 ], [ 6.132308071095699, 45.9372562104884 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Dessin GC - R3" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132257959648957, 45.937320732088672 ], [ 6.132446383258118, 45.937308855641085 ], [ 6.132457385673736, 45.937376307766222 ], [ 6.132265644031364, 45.937386943240483 ], [ 6.132257959648957, 45.937320732088672 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V14" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132680458377678, 45.937160127816881 ], [ 6.13268444425343, 45.93719371934894 ], [ 6.132714735193187, 45.937212495320104 ], [ 6.132678298265654, 45.937241498840308 ], [ 6.132656787308436, 45.937230050084146 ], [ 6.132606247533951, 45.937268403407998 ], [ 6.13259702794009, 45.937201523971432 ], [ 6.132645770840243, 45.937162152296104 ], [ 6.132680458377678, 45.937160127816881 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V13" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132704391276252, 45.937255409075881 ], [ 6.132680520698729, 45.937275558875939 ], [ 6.132709140526577, 45.93729225019387 ], [ 6.132747029066454, 45.937289907971518 ], [ 6.13274682438953, 45.937282925639479 ], [ 6.132787441839407, 45.937250643096419 ], [ 6.132783834884398, 45.937219560224705 ], [ 6.132734572504311, 45.937222835514987 ], [ 6.132714707755736, 45.937212514401381 ], [ 6.132678380577984, 45.937241479759059 ], [ 6.132704391276252, 45.937255409075881 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "R2 STS Bâtiment" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132517459296714, 45.937399871311889 ], [ 6.132565327156417, 45.937362287844401 ], [ 6.132610983065614, 45.937391062311796 ], [ 6.132628543030697, 45.937553843848384 ], [ 6.132534726793107, 45.937558629070274 ], [ 6.132517459296714, 45.937399871311889 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "R1 STS Bâtiment" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132628529311978, 45.937553834307799 ], [ 6.132643661063136, 45.937693851615414 ], [ 6.132550702998013, 45.937698087621293 ], [ 6.13253499115222, 45.937558968042602 ], [ 6.132628529311978, 45.937553834307799 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V11" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132751257005316, 45.937338674833427 ], [ 6.132755976245933, 45.937394124845142 ], [ 6.132697040613148, 45.937397597624489 ], [ 6.13269594311533, 45.937385843601234 ], [ 6.132667572796755, 45.93738767539724 ], [ 6.132661317059195, 45.937344361038136 ], [ 6.132751257005316, 45.937338674833427 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "EDF" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132512071074854, 45.937730029374599 ], [ 6.132555092989289, 45.937728502887367 ], [ 6.13256720738637, 45.937827850296451 ], [ 6.132523666101738, 45.937830593630423 ], [ 6.132512071074854, 45.937730029374599 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V4" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132773728273156, 45.937548854127066 ], [ 6.132780519040903, 45.937611106352279 ], [ 6.132713695142558, 45.937614226117127 ], [ 6.132712529051139, 45.937605610986267 ], [ 6.132686367446902, 45.937606402853248 ], [ 6.132683733452141, 45.937583734462919 ], [ 6.132729389361338, 45.937550151645418 ], [ 6.132773728273156, 45.937548854127066 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V10" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132697726549297, 45.93740776790564 ], [ 6.132697095488052, 45.937397559462106 ], [ 6.132755839058721, 45.937394086682787 ], [ 6.132760651254606, 45.937446578535969 ], [ 6.132675611968283, 45.937451482920103 ], [ 6.132670069604303, 45.937409294401711 ], [ 6.132697726549297, 45.93740776790564 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V9" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13267621559208, 45.937451425676542 ], [ 6.132760585736782, 45.937446559973907 ], [ 6.132766923786677, 45.937515595668145 ], [ 6.132726096867875, 45.937517427459859 ], [ 6.132681757956058, 45.937491171772862 ], [ 6.13267621559208, 45.937451425676542 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V8" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132844544319799, 45.937441866001585 ], [ 6.13285080005736, 45.937494339247479 ], [ 6.132837410583988, 45.937495274224858 ], [ 6.132838508081803, 45.937513573064813 ], [ 6.132766951224119, 45.937515557505897 ], [ 6.132760530861888, 45.937446521811594 ], [ 6.132844544319799, 45.937441866001585 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13289620121191, 45.937439206606143 ], [ 6.132947639526813, 45.937436534579568 ], [ 6.132953049959326, 45.937481250109293 ], [ 6.13290114117203, 45.937483758540381 ], [ 6.13289620121191, 45.937439206606143 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V6" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132869841644498, 45.93754551492529 ], [ 6.132917198675309, 45.937544942490668 ], [ 6.132922905663959, 45.937602643869987 ], [ 6.132863777969059, 45.93760583041928 ], [ 6.132859305665451, 45.937565092185501 ], [ 6.132870609892968, 45.937564596075688 ], [ 6.132869841644498, 45.93754551492529 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132533074937031, 45.937322475733509 ], [ 6.132581788432659, 45.937349455071761 ], [ 6.132538436362003, 45.93738344165758 ], [ 6.132492075228335, 45.937357041730223 ], [ 6.132533074937031, 45.937322475733509 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13255515773495, 45.937728684477079 ], [ 6.132559181168663, 45.937761952029298 ], [ 6.132631923146978, 45.93775698599061 ], [ 6.132629021900557, 45.937723394982591 ], [ 6.13255515773495, 45.937728684477079 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132206184714567, 45.937339523948609 ], [ 6.132182146939924, 45.93735989792166 ], [ 6.132208419581737, 45.937373987308597 ], [ 6.132231707965161, 45.937355937472724 ], [ 6.132206184714567, 45.937339523948609 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132109463555203, 45.937346721693224 ], [ 6.132161450754563, 45.937376713869369 ], [ 6.132138476019402, 45.937393727605723 ], [ 6.132086175171779, 45.937365098719432 ], [ 6.132109463555203, 45.937346721693224 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Escalier" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132287223707468, 45.937205158402804 ], [ 6.132336936956933, 45.937233187526743 ], [ 6.132293748749182, 45.937267697401651 ], [ 6.132240725352684, 45.93723885878746 ], [ 6.132263249218473, 45.937221735940867 ], [ 6.132287223707468, 45.937205158402804 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V21" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132285143680348, 45.936985997817807 ], [ 6.132179509515824, 45.936990768154132 ], [ 6.132184863246976, 45.937033732169844 ], [ 6.132203434968155, 45.937032747096147 ], [ 6.132205190964656, 45.937042516736291 ], [ 6.132290356794962, 45.937038242518945 ], [ 6.132285143680348, 45.936985997817807 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V20" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132290353365288, 45.937038240133788 ], [ 6.132205221831484, 45.937042509580856 ], [ 6.132206840640763, 45.93705450219344 ], [ 6.132187510960462, 45.937055427637596 ], [ 6.132194596680746, 45.937113487300728 ], [ 6.132297658585135, 45.937108836233037 ], [ 6.132290353365288, 45.937038240133788 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V19" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132297548835356, 45.937108759907822 ], [ 6.132303008886997, 45.937163923930186 ], [ 6.132225086541987, 45.937168436653955 ], [ 6.132223632357366, 45.937158848308158 ], [ 6.132200324247481, 45.937160832761975 ], [ 6.132194589821385, 45.937113492071049 ], [ 6.132297548835356, 45.937108759907822 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Chef des travaux" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132076224681802, 45.937303264838846 ], [ 6.132127422954976, 45.937332344636481 ], [ 6.132176974981426, 45.937292350370178 ], [ 6.132125831583141, 45.937264110126598 ], [ 6.132071615190971, 45.937267315776587 ], [ 6.132076224681802, 45.937303264838846 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132125804145699, 45.937264110126598 ], [ 6.132172118553585, 45.937261267020205 ], [ 6.13217705729376, 45.937292369451427 ], [ 6.132125804145699, 45.937264110126598 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "GC Profs" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132446410695565, 45.937308836559879 ], [ 6.13247291526785, 45.937306966598811 ], [ 6.132520766172685, 45.937332611773769 ], [ 6.13249209404221, 45.937356997576451 ], [ 6.132467702153222, 45.93737562084263 ], [ 6.13245744054863, 45.937376288685044 ], [ 6.132446410695565, 45.937308836559879 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V17" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132308119111237, 45.937256215258714 ], [ 6.132359433993552, 45.937284193139213 ], [ 6.132441554267731, 45.937278964878224 ], [ 6.132430689039342, 45.937212180479086 ], [ 6.132359241931439, 45.937215767757429 ], [ 6.132308119111237, 45.937256215258714 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V15" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132517130711181, 45.937206389313886 ], [ 6.13259724805184, 45.937201466345925 ], [ 6.132606302408835, 45.937268517895475 ], [ 6.132539135542419, 45.937272639445091 ], [ 6.132536172298312, 45.937253634519237 ], [ 6.132524785758457, 45.937254054306834 ], [ 6.132517130711181, 45.937206389313886 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132680575573622, 45.93727553979469 ], [ 6.132709154245301, 45.937292259734491 ], [ 6.13265423562601, 45.93729568958743 ], [ 6.132680575573622, 45.93727553979469 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.13274730344091, 45.93728988889027 ], [ 6.132748949687636, 45.937307672604646 ], [ 6.132656540371424, 45.93731332065007 ], [ 6.132654564875353, 45.93729568958743 ], [ 6.13274730344091, 45.93728988889027 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "VDI0" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132748719041615, 45.937307648753091 ], [ 6.132751462786156, 45.937338560346042 ], [ 6.13266124846558, 45.937344361038136 ], [ 6.132656529224967, 45.93731322047357 ], [ 6.132748719041615, 45.937307648753091 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V7" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132844654069588, 45.937441866001564 ], [ 6.132896181592108, 45.937439270959757 ], [ 6.132903644577266, 45.937511474136642 ], [ 6.132865012654101, 45.937513305928498 ], [ 6.132863146907809, 45.937493919461708 ], [ 6.132850800057366, 45.93749426292279 ], [ 6.132844654069588, 45.937441866001564 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V5" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132859333102897, 45.937565073104345 ], [ 6.132863723094168, 45.93760583041928 ], [ 6.132780532759623, 45.93761113497397 ], [ 6.132773728273158, 45.937548930451669 ], [ 6.132842870635642, 45.937546946011778 ], [ 6.132845065631278, 45.937565340240411 ], [ 6.132859333102897, 45.937565073104345 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "V3" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132780738540482, 45.937611144514577 ], [ 6.13278578703044, 45.937672356749367 ], [ 6.132694914211173, 45.937674951780274 ], [ 6.132688987722962, 45.937628241205417 ], [ 6.132715547170139, 45.937627172662388 ], [ 6.132713818611077, 45.937614216576598 ], [ 6.132780738540482, 45.937611144514577 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": "Sanitaire" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132786033967446, 45.937672051451607 ], [ 6.1327869119657, 45.937680141841703 ], [ 6.132835860368347, 45.937707771278284 ], [ 6.132840030860055, 45.937737843080349 ], [ 6.132792179955223, 45.937742269892468 ], [ 6.132736207566544, 45.937710518956308 ], [ 6.132734890569162, 45.937691285207293 ], [ 6.132762547514156, 45.937690979909625 ], [ 6.132761587203566, 45.937673081831548 ], [ 6.132786033967446, 45.937672051451607 ] ] ] ] } },
{ "type": "Feature", "properties": { "name": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 6.132395173838695, 45.936744396442087 ], [ 6.132401429576253, 45.936794771392712 ], [ 6.132443902741779, 45.936792786925814 ], [ 6.132440939497673, 45.936772636950352 ], [ 6.132395173838695, 45.936744396442087 ] ] ] ] } }
]
    };

    var CheminEtage0 = {
        "type": "FeatureCollection",
"features":[
        {"type":"Feature","properties":{"name":"8","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13217,45.93707],[6.13212,45.93707]]}},
        {"type":"Feature","properties":{"name":"10","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.1321,45.93685],[6.13215,45.93685]]}},
        {"type":"Feature","properties":{"name":"Réunion","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13273,45.93773],[6.13269,45.93776]]}},
        {"type":"Feature","properties":{"name":"1","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13276,45.93756],[6.13276,45.93759]]}},
        {"type":"Feature","properties":{"name":"6","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13232,45.9373],[6.13232,45.93733]]}},
        {"type":"Feature","properties":{"name":"11","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13214,45.93677],[6.13215,45.9368]]}},
        {"type":"Feature","properties":{"name":"14","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13229,45.93681],[6.13228,45.93679]]}},
        {"type":"Feature","properties":{"name":"CDI","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13266,45.93761],[6.13261,45.93761]]}},
        {"type":"Feature","properties":{"name":"Proviseur","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13285,45.9375],[6.13285,45.93747]]}},
        {"type":"Feature","properties":{"name":"0","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13218,45.93707],[6.13223,45.93707]]}},
        {"type":"Feature","properties":{"name":"12","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13225,45.93677],[6.13225,45.93679]]}},
        {"type":"Feature","properties":{"name":"Acceuil","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13284,45.93754],[6.13287,45.93756]]}},
        {"type":"Feature","properties":{"name":"7","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13219,45.93717],[6.13214,45.93718]]}},
        {"type":"Feature","properties":{"name":"7.8","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13218,45.93714],[6.13213,45.93714]]}},
        {"type":"Feature","properties":{"name":"13","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13242,45.9368],[6.13242,45.93678]]}},
        {"type":"Feature","properties":{"name":"2","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13266,45.9376],[6.13272,45.93761]]}},
        {"type":"Feature","properties":{"name":"Intendance","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13264,45.9374],[6.1327,45.9374]]}},
        {"type":"Feature","properties":{"name":"Vie scolaire","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13237,45.9373],[6.13237,45.93732]]}},
        {"type":"Feature","properties":{"name":"9","foot":"yes","highway":"footway"},"geometry":{"type":"LineString","coordinates":[[6.13215,45.93687],[6.13209,45.93688]]}},
      ]
    };

    var CheminEtage1 = {
      "type": "FeatureCollection",
      "features":[
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"116"},"geometry":{"type":"LineString","coordinates":[[6.13218,45.93718],[6.13214,45.93718]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"113"},"geometry":{"type":"LineString","coordinates":[[6.13216,45.93702],[6.13221,45.93701]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"106"},"geometry":{"type":"LineString","coordinates":[[6.13266,45.93757],[6.13262,45.93757]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"115"},"geometry":{"type":"LineString","coordinates":[[6.1322,45.93681],[6.1322,45.9368]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"Audio visuel"},"geometry":{"type":"LineString","coordinates":[[6.13275,45.93753],[6.13275,45.93756]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"101"},"geometry":{"type":"LineString","coordinates":[[6.13267,45.93766],[6.13273,45.93766]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"103"},"geometry":{"type":"LineString","coordinates":[[6.13263,45.93739],[6.13269,45.93738]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"108"},"geometry":{"type":"LineString","coordinates":[[6.13265,45.9375],[6.13259,45.93751]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"109"},"geometry":{"type":"LineString","coordinates":[[6.1324,45.9373],[6.13239,45.93727]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"Labo"},"geometry":{"type":"LineString","coordinates":[[6.13215,45.93687],[6.1321,45.93687]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"118"},"geometry":{"type":"LineString","coordinates":[[6.13217,45.93708],[6.13211,45.93708]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"117"},"geometry":{"type":"LineString","coordinates":[[6.13242,45.93678],[6.13242,45.9368]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"104"},"geometry":{"type":"LineString","coordinates":[[6.13266,45.9376],[6.13261,45.9376]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"114"},"geometry":{"type":"LineString","coordinates":[[6.13235,45.9373],[6.13235,45.93733]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"Video lecture"},"geometry":{"type":"LineString","coordinates":[[6.13274,45.93753],[6.13273,45.9375]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"124"},"geometry":{"type":"LineString","coordinates":[[6.13224,45.93678],[6.13224,45.93679]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"110"},"geometry":{"type":"LineString","coordinates":[[6.13264,45.93741],[6.13257,45.93742]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"107"},"geometry":{"type":"LineString","coordinates":[[6.13257,45.93729],[6.13257,45.93725]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"1"},"geometry":{"type":"LineString","coordinates":[[6.13271,45.93771],[6.13268,45.93775]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"120"},"geometry":{"type":"LineString","coordinates":[[6.13216,45.93697],[6.13211,45.93698]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"122"},"geometry":{"type":"LineString","coordinates":[[6.13215,45.93681],[6.1321,45.93681]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"111"},"geometry":{"type":"LineString","coordinates":[[6.13217,45.93711],[6.13221,45.93711]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"Germain somelier"},"geometry":{"type":"LineString","coordinates":[[6.13324,45.9375],[6.13318,45.93746]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"102"},"geometry":{"type":"LineString","coordinates":[[6.13267,45.93767],[6.13262,45.93767]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"112"},"geometry":{"type":"LineString","coordinates":[[6.13243,45.9373],[6.13243,45.93733]]}},
        {"type":"Feature","properties":{"highway":"footway","foot":"yes","name":"105"},"geometry":{"type":"LineString","coordinates":[[6.13263,45.93731],[6.13268,45.9373]]}},

    ]
    };

    var CheminEtage2 = {
      "type": "FeatureCollection",
      
"features":[
{"type":"Feature","properties":{"foot":"yes","name":"V7","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13288,45.9375],[6.13285,45.9375]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V19","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13224,45.93712],[6.13218,45.93713]]}},
{"type":"Feature","properties":{"foot":"yes","name":"R2 STS Bâtiment","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13258,45.93754],[6.13265,45.93753]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V3","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13275,45.93766],[6.13266,45.93767]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V10","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13272,45.93744],[6.13264,45.93745]]}},
{"type":"Feature","properties":{"foot":"yes","name":"Adjoint","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13208,45.93733],[6.13215,45.93735]]}},
{"type":"Feature","properties":{"foot":"yes","name":"R11","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13238,45.93681],[6.13238,45.93679]]}},
{"type":"Feature","properties":{"foot":"yes","name":"R1 STS Bâtiment","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.1326,45.93768],[6.13267,45.93768]]}},
{"type":"Feature","properties":{"foot":"yes","name":"VDI0","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.1327,45.93733],[6.13263,45.93734]]}},
{"type":"Feature","properties":{"layer":"-2","highway":"footway","tunnel":"yes","name":"V11","foot":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13272,45.93736],[6.13263,45.93736]]}},
{"type":"Feature","properties":{"foot":"yes","name":"R6","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13206,45.93689],[6.13215,45.93688]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V4","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13273,45.9376],[6.13266,45.93759]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V17","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13237,45.93725],[6.13238,45.93729]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V20","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13223,45.9371],[6.13217,45.9371]]}},
{"type":"Feature","properties":{"foot":"yes","name":"Dessin GC - R3","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13229,45.93736],[6.13228,45.9373]]}},
{"type":"Feature","properties":{"foot":"yes","name":"R11","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13219,45.93682],[6.13219,45.9368]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V1","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13259,45.93777],[6.13262,45.93777]]}},
{"type":"Feature","properties":{"foot":"yes","name":"2","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13211,45.9373],[6.13216,45.93733]]}},
{"type":"Feature","properties":{"foot":"yes","name":"R8","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13211,45.93678],[6.13213,45.9368]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V2","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13272,45.9378],[6.13268,45.93775]]}},
{"type":"Feature","properties":{"foot":"yes","name":"R7","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13207,45.93684],[6.13214,45.93684]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V9","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13272,45.93747],[6.13264,45.93748]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V21","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13219,45.93702],[6.1322,45.93704]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V5","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.1328,45.93758],[6.13279,45.93753]]}},
{"type":"Feature","properties":{"foot":"yes","name":"GC Profs","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13247,45.93733],[6.1325,45.93731]]}},
{"type":"Feature","properties":{"foot":"yes","name":"R9","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13224,45.93676],[6.13225,45.93679]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V18","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13223,45.9372],[6.13221,45.93717]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V15","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13259,45.93725],[6.13259,45.93728]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V8","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13279,45.9375],[6.13279,45.93753]]}},
{"type":"Feature","properties":{"foot":"yes","name":"R5","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13209,45.93703],[6.13216,45.93702]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V6","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13288,45.93756],[6.13286,45.93756]]}},
{"type":"Feature","properties":{"foot":"yes","name":"R4","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.1321,45.93716],[6.13218,45.93715]]}},
{"type":"Feature","properties":{"foot":"yes","name":"Coordinateur secteurs","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13219,45.93738],[6.13217,45.93736]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V16","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13245,45.93726],[6.13246,45.93729]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V14","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13262,45.93723],[6.13266,45.93726]]}},
{"type":"Feature","properties":{"foot":"yes","name":"V13","highway":"footway","layer":"-2","tunnel":"yes"},"geometry":{"type":"LineString","coordinates":[[6.13272,45.93727],[6.13266,45.93726]]}}
]
    };

    // --- 3. Création des couches GeoJSON pour les salles ---
    // On n'utilise plus bindTooltip ici afin d'éviter que le label s'affiche automatiquement au survol.
    function onEachSalleFeature(feature, layer, floor) {
  feature.properties.floor = floor;
  // Pour l'étage 1, si 'name' n'existe pas, le récupérer via 'salle'
  if (floor === "1" && feature.properties.salle && !feature.properties.name) {
    feature.properties.name = feature.properties.salle;
  }
  layer.on({
    mouseover: function(e) {
      e.target.setStyle({
        color: '#6AB28F',
        weight: 3
      });
    },
    mouseout: function(e) {
      if (floor === "0") {
        salleLayer0.resetStyle(e.target);
      } else if (floor === "1") {
        salleLayer1.resetStyle(e.target);
      } else if (floor === "2") {
        salleLayer2.resetStyle(e.target);
      }
    },
    click: function(e) {
      // Reset all highlights first
      resetHighlight();
      // Zoom to the clicked feature
      map.fitBounds(e.target.getBounds());
    }
  });
}

    var salleLayer0 = L.geoJSON(salleEtage0, {
      style: function(feature) {
        return { color: '#81CAA7', weight: 2, fillOpacity: 0.8 };
      },
      onEachFeature: function(feature, layer) {
         onEachSalleFeature(feature, layer, "0");
      }
    });

    var salleLayer1 = L.geoJSON(salleEtage1, {
      style: function(feature) {
        return { color: '#9EF3CA', weight: 2, fillOpacity: 0.8 };
      },
      onEachFeature: function(feature, layer) {
         onEachSalleFeature(feature, layer, "1");
      }
    });

    var salleLayer2 = L.geoJSON(salleEtage2, {
      style: function(feature) {
        return { color: '#ffffff', weight: 2, fillOpacity: 0.8 }; // modifiez la couleur au besoin
      },
      onEachFeature: function(feature, layer) {
        onEachSalleFeature(feature, layer, "2");
      }
    });

    // --- 4. Calque des chemins ---
    //var CheminEtageLayer = L.geoJSON(CheminEtage, {
     // style: { color: 'transparent' }
    //});
   // CheminEtageLayer.addTo(map);

   var CheminEtageLayer0 = L.geoJSON(CheminEtage0, {
      style: { color: 'transparent' }
    });

    var CheminEtageLayer1 = L.geoJSON(CheminEtage1, {
      style: { color: 'transparent' }
    });

    var CheminEtageLayer2 = L.geoJSON(CheminEtage2, {
      style: { color: 'transparent' }
    });

    // --- 5. Couches d'itinéraire (initialement vides) ---
    var itinéraireEtage0 = { "type": "FeatureCollection", "features": [] };
    var itinéraireEtage1 = { "type": "FeatureCollection", "features": [] };
    var itinéraireEtage2 = { "type": "FeatureCollection", "features": [] };

    var itinéraireLayer0 = L.geoJSON(itinéraireEtage0, { style: { color: '#3A5AC3', weight: 10 } });
    var itinéraireLayer1 = L.geoJSON(itinéraireEtage1, { style: { color: '#7898FF', weight: 10 } });
    var itinéraireLayer2 = L.geoJSON(itinéraireEtage2, { style: { color: '#FFA500', weight: 10 } });

    // --- 6. Fonds de carte personnalisés pour chaque groupe (en plus du fond par défaut) ---
    var customBackground0 = L.tileLayer('Données/QGIS/QTiles/etage0/{z}/{x}/{y}.png', {
      opacity: 1,
      maxZoom: 23
    });
    var customBackground1 = L.tileLayer('Données/QGIS/QTiles/etage1/{z}/{x}/{y}.png', {
      opacity: 1,
      maxZoom: 23 
    });
    var customBackground2 = L.tileLayer('Données/QGIS/QTiles/etage2/{z}/{x}/{y}.png', {
      opacity: 1,
      maxZoom: 23
    });

    // --- 7. Groupes par étage en ajoutant le fond personnalisé dans le groupe ---
    var etage0 = L.layerGroup([ customBackground0, salleLayer0, itinéraireLayer0, CheminEtageLayer0 ]);
    var etage1 = L.layerGroup([ customBackground1, salleLayer1, itinéraireLayer1, CheminEtageLayer1 ]);
    var etage2 = L.layerGroup([ customBackground2, salleLayer2, itinéraireLayer2, CheminEtageLayer2 ]);
    // Par défaut, le groupe de l'étage 0 est affiché.
    etage0.addTo(map);

    // --- 8. Gestion des labels (tooltips) en fonction du niveau de zoom ---
    // Ici, on crée manuellement un tooltip permanent pour chaque feature lorsque le zoom est suffisant.
    const tooltipZoomThreshold = 20; // Seuil de zoom pour afficher les labels

    function updateTooltipsVisibility() {
  var currentZoom = map.getZoom();
  
  // Pour etage0
  if (map.hasLayer(etage0)) {
    salleLayer0.eachLayer(function(layer) {
      if (currentZoom >= tooltipZoomThreshold) {
        if (!layer._customTooltip) {
          var name = layer.feature.properties.name;
          if (name) {
            var center = layer.getBounds().getCenter();
            var tooltip = L.tooltip({
              permanent: true,
              direction: 'center',
              className: 'room-label'
            })
            .setContent(name)
            .setLatLng(center);
            tooltip.addTo(map);
            layer._customTooltip = tooltip;
          }
        }
      } else if (layer._customTooltip) {
        map.removeLayer(layer._customTooltip);
        layer._customTooltip = null;
      }
    });
  } else {
    salleLayer0.eachLayer(function(layer) {
      if (layer._customTooltip) {
        map.removeLayer(layer._customTooltip);
        layer._customTooltip = null;
      }
    });
  }
  
  // Pour etage1
  if (map.hasLayer(etage1)) {
    salleLayer1.eachLayer(function(layer) {
      if (currentZoom >= tooltipZoomThreshold) {
        if (!layer._customTooltip) {
          var name = layer.feature.properties.name;
          if (name) {
            var center = layer.getBounds().getCenter();
            var tooltip = L.tooltip({
              permanent: true,
              direction: 'center',
              className: 'room-label'
            })
            .setContent(name)
            .setLatLng(center);
            tooltip.addTo(map);
            layer._customTooltip = tooltip;
          }
        }
      } else if (layer._customTooltip) {
        map.removeLayer(layer._customTooltip);
        layer._customTooltip = null;
      }
    });
  } else {
    salleLayer1.eachLayer(function(layer) {
      if (layer._customTooltip) {
        map.removeLayer(layer._customTooltip);
        layer._customTooltip = null;
      }
    });
  }
  
  // Pour etage2
  if (map.hasLayer(etage2)) {
    salleLayer2.eachLayer(function(layer) {
      if (currentZoom >= tooltipZoomThreshold) {
        if (!layer._customTooltip) {
          var name = layer.feature.properties.name;
          if (name) {
            var center = layer.getBounds().getCenter();
            var tooltip = L.tooltip({
              permanent: true,
              direction: 'center',
              className: 'room-label'
            })
            .setContent(name)
            .setLatLng(center);
            tooltip.addTo(map);
            layer._customTooltip = tooltip;
          }
        }
      } else if (layer._customTooltip) {
        map.removeLayer(layer._customTooltip);
        layer._customTooltip = null;
      }
    });
  } else {
    salleLayer2.eachLayer(function(layer) {
      if (layer._customTooltip) {
        map.removeLayer(layer._customTooltip);
        layer._customTooltip = null;
      }
    });
  }
}

map.on('zoomend', updateTooltipsVisibility);
updateTooltipsVisibility();


    // --- 9. Basculement automatique du calque en fonction de la salle recherchée ---
    function switchFloor(floor) {
  // Supprime tous les tooltips personnalisés pour tous les calques
  salleLayer0.eachLayer(function(layer) {
    if (layer._customTooltip) {
      map.removeLayer(layer._customTooltip);
      layer._customTooltip = null;
    }
  });
  salleLayer1.eachLayer(function(layer) {
    if (layer._customTooltip) {
      map.removeLayer(layer._customTooltip);
      layer._customTooltip = null;
    }
  });
  salleLayer2.eachLayer(function(layer) {
    if (layer._customTooltip) {
      map.removeLayer(layer._customTooltip);
      layer._customTooltip = null;
    }
  });

  // Basculement du calque visible
  if (floor === "0") {
    if (!map.hasLayer(etage0)) { map.addLayer(etage0); }
    if (map.hasLayer(etage1)) { map.removeLayer(etage1); }
    if (map.hasLayer(etage2)) { map.removeLayer(etage2); }
  } else if (floor === "1") {
    if (!map.hasLayer(etage1)) { map.addLayer(etage1); }
    if (map.hasLayer(etage0)) { map.removeLayer(etage0); }
    if (map.hasLayer(etage2)) { map.removeLayer(etage2); }
  } else if (floor === "2") {
    if (!map.hasLayer(etage2)) { map.addLayer(etage2); }
    if (map.hasLayer(etage0)) { map.removeLayer(etage0); }
    if (map.hasLayer(etage1)) { map.removeLayer(etage1); }
  }
  updateTooltipsVisibility();
  updateMarkersVisibility();
}

var StartIcon = L.icon({
    iconUrl: 'image/starticon.png',

    iconSize:     [15, 15], // size of the icon
    iconAnchor:   [7.5, 7.5], // point of the icon which will correspond to marker's location
    popupAnchor:  [0, -10] // point from which the popup should open relative to the iconAnchor
});

var EndIcon = L.icon({
    iconUrl: 'image/endicon.png',

    iconSize:     [15, 15], // size of the icon
    iconAnchor:   [7.5, 7.5], // point of the icon which will correspond to marker's location
    popupAnchor:  [0, -10] // point from which the popup should open relative to the iconAnchor
});

var markersGroup = L.layerGroup().addTo(map);



    // --- 10. Variables pour la gestion des marqueurs de départ et d'arrivée ---
    var startPoint = null;
    var endPoint   = null;

    // --- 11. Fonctions de surlignage (pour les recherches) ---
    function highlightFeature(layer) {
      layer.setStyle({ color: '#6AB28F', weight: 3, fillOpacity: 0.9 });
      layer.bringToFront();
    }
    // Modified resetHighlight function - REPLACE THIS SECTION
    function resetHighlight() {
      salleLayer0.eachLayer(function(layer) {
        salleLayer0.resetStyle(layer);
        if (layer._customTooltip) {
          map.removeLayer(layer._customTooltip);
          layer._customTooltip = null;
        }
      });
      salleLayer1.eachLayer(function(layer) {
        salleLayer1.resetStyle(layer);
        if (layer._customTooltip) {
          map.removeLayer(layer._customTooltip);
          layer._customTooltip = null;
        }
      });
    }

    // --- 12. Vérification et calcul de l'itinéraire ---
    function checkAndCalculateRoute() {
      if (startPoint && endPoint) {
        var startCoords = [ startPoint.getLatLng().lat, startPoint.getLatLng().lng ];
        var endCoords   = [ endPoint.getLatLng().lat, endPoint.getLatLng().lng ];
        getRouteAndPoints(startCoords, endCoords);
      }
    }

    // --- 13. Barre de recherche pour le marqueur de départ ---
  var searchGroup = L.featureGroup();
  salleLayer0.eachLayer(function(layer) {
    searchGroup.addLayer(layer);
  });
  salleLayer1.eachLayer(function(layer) {
    searchGroup.addLayer(layer);
  });
  // Après avoir ajouté salleLayer0 et salleLayer1 à searchGroup
  salleLayer2.eachLayer(function(layer) {
    searchGroup.addLayer(layer);
  });
  
  var searchControlStart = new L.Control.Search({
      layer: searchGroup,
      propertyName: 'name',
      marker: false,
      collapsed: false,
      moveToLocation: function(latlng, title, map) {
        // Laisser le zoom personnalisé se gérer ailleurs
      },
      position: 'topleft',
      textPlaceholder: "Point de départ"
  });
  map.addControl(searchControlStart);
  // Ajout de l'id au container du contrôle start
  searchControlStart.getContainer().id = "search-control-start";
  // Lorsqu'une recherche est ouverte, ajouter un id au tooltip
  searchControlStart.on('search:expanded', function() {
      if (this._tooltip) {
          this._tooltip.id = "search-tooltip-start";
      }
  });
  
  searchControlStart.on('search:locationfound', function(e) {
    resetHighlight();
    if (startPoint) { map.removeLayer(startPoint); startPoint = null; }
    var salleFeature = e.layer;
    switchFloor(salleFeature.feature.properties.floor);
    var matchingFeatures = [];
    searchGroup.eachLayer(function(layer) {
        if (layer.feature.properties.name === salleFeature.feature.properties.name) {
            matchingFeatures.push(layer);
        }
    });
    if (matchingFeatures.length > 0) {
        var group = new L.featureGroup(matchingFeatures);
        map.fitBounds(group.getBounds());
        matchingFeatures.forEach(function(layer) {
            highlightFeature(layer);
        });
        var cheminFeature = null;
        var cheminLayer = (salleFeature.feature.properties.floor === "0") ? CheminEtageLayer0 :
                          (salleFeature.feature.properties.floor === "1") ? CheminEtageLayer1 :
                          CheminEtageLayer2;
        cheminLayer.eachLayer(function(layer) {
            if (layer.feature && layer.feature.properties.name === salleFeature.feature.properties.name) {
                cheminFeature = layer;
            }
        });
        if (cheminFeature) {
            var center = cheminFeature.getBounds().getCenter();
            startPoint = L.marker(center, {icon: StartIcon, floor: salleFeature.feature.properties.floor}).addTo(map)
                .bindPopup("Point de départ sur le chemin de " + salleFeature.feature.properties.name, { autoPan: false })
                .openPopup();
        }
    }
    updateMarkersVisibility(); // Assurez-vous que cette fonction est appelée après avoir ajouté le marqueur
    checkAndCalculateRoute();
});

  // --- 14. Barre de recherche pour le marqueur de fin ---
  var searchControlEnd = new L.Control.Search({
      layer: searchGroup,
      propertyName: 'name',
      marker: false,
      collapsed: false,
      moveToLocation: function(latlng, title, map) {
        // Pas d'action ici
      },
      position: 'topleft',
      textPlaceholder: "Point d\'arrivée"
  });
  map.addControl(searchControlEnd);
  // Ajout de l'id au container du contrôle end
  searchControlEnd.getContainer().id = "search-control-end";
  // Lorsqu'une recherche est ouverte, ajouter un id au tooltip
  searchControlEnd.on('search:expanded', function() {
      if (this._tooltip) {
          this._tooltip.id = "search-tooltip-end";
      }
  });

  searchControlEnd.on('search:locationfound', function(e) {
  resetHighlight();
  if (endPoint) { 
      map.removeLayer(endPoint); 
      endPoint = null; 
  }
  var salleFeature = e.layer;
  switchFloor(salleFeature.feature.properties.floor);
  
  var matchingFeatures = [];
  searchGroup.eachLayer(function(layer) {
      if (layer.feature.properties.name === salleFeature.feature.properties.name) {
          matchingFeatures.push(layer);
      }
  });
  
  if (matchingFeatures.length > 0) {
      var group = new L.featureGroup(matchingFeatures);
      map.fitBounds(group.getBounds());
      matchingFeatures.forEach(function(layer) {
          highlightFeature(layer);
      });
      
      var cheminFeature = null;
      var cheminLayer = null;
      // Gestion multi-étages (0, 1 ou 2)
      if (salleFeature.feature.properties.floor === "0") {
          cheminLayer = CheminEtageLayer0;
      } else if (salleFeature.feature.properties.floor === "1") {
          cheminLayer = CheminEtageLayer1;
      } else if (salleFeature.feature.properties.floor === "2") {
          cheminLayer = CheminEtageLayer2;
      }
      
      if (cheminLayer) {
          cheminLayer.eachLayer(function(layer) {
              if (layer.feature && layer.feature.properties.name === salleFeature.feature.properties.name) {
                  cheminFeature = layer;
              }
          });
      }
      var center;
      // Si un segment chemin est trouvé, on l'utilise, sinon on prend le centre de la salle
      if (cheminFeature && cheminFeature.getBounds) {
          center = cheminFeature.getBounds().getCenter();
      } else if (salleFeature.getBounds) {
          center = salleFeature.getBounds().getCenter();
      } else {
          center = e.latlng;
      }
      
      endPoint = L.marker(center, {icon: EndIcon, floor: salleFeature.feature.properties.floor})
                  .addTo(map)
                  .bindPopup("Point de fin sur le chemin de " + salleFeature.feature.properties.name, { autoPan: false })
                  .openPopup();
  }
  updateMarkersVisibility(); // S'assurer que l'affichage des marqueurs est à jour
  checkAndCalculateRoute();
});

  searchControlStart.on('search:expanded', function() {
    if (this._tooltip) {
        this._tooltip.id = "search-tooltip-start";
        this._tooltip.classList.add('search-tooltip-start'); // Ajoute une classe spécifique
        console.log("ID de la tooltip de recherche de départ :", this._tooltip.id);
    }
});

searchControlEnd.on('search:expanded', function() {
    if (this._tooltip) {
        this._tooltip.id = "search-tooltip-end";
        this._tooltip.classList.add('search-tooltip-end'); // Ajoute une classe spécifique
        console.log("ID de la tooltip de recherche de fin :", this._tooltip.id);
    }
});

    // Fonction pour récupérer et filtrer les segments
function getRouteAndPoints(start, end) {
  var osrmUrl = `https://classefinder.duckdns.org/osrm/route/v1/driving/${start[1]},${start[0]};${end[1]},${end[0]}?steps=true&geometries=geojson&overview=full`;
  
  fetch(osrmUrl)
    .then(response => response.json())
    .then(data => {
      if (data.routes && data.routes.length > 0) {
        var route = data.routes[0];
        
        // Nettoyer les anciennes données des calques
        itinéraireLayer0.clearLayers();
        itinéraireLayer1.clearLayers();
        itinéraireLayer2.clearLayers();
        
        route.legs[0].steps.forEach((step, index) => {
          var startName = step.name || "";
          var segment = {
            type: "Feature",
            geometry: {
              type: "LineString",
              coordinates: step.geometry.coordinates
            },
            properties: { name: startName }
          };
          
          if (startName.toLowerCase().includes("0")) {
            itinéraireLayer0.addData(segment);
          }
          if (startName.toLowerCase().includes("1")) {
            itinéraireLayer1.addData(segment);
          }
          if (startName.toLowerCase().includes("2")) {
            itinéraireLayer2.addData(segment);
          }
        });
        
        var bounds = L.geoJSON(route.geometry).getBounds();
        map.fitBounds(bounds);
      }
    })
    .catch(error => {
      console.error('Erreur lors de la récupération de l\'itinéraire:', error);
    });
}


    // --- 16. Contrôle des calques via le sélecteur ---
    var baseLayers = {
      "Étage 1": etage1,
      "Étage 0": etage0,
      "Étage -1": etage2,

};
L.control.layers(baseLayers, null, { collapsed: false }).addTo(map);

    // Listen for layer changes and update tooltips
    map.on('baselayerchange', function(e) {
      updateTooltipsVisibility();
      updateMarkersVisibility();
    });

    map.on('baselayerchange', function(e) {
      updateTooltipsVisibility();
      updateMarkersVisibility();
    });

    map.removeLayer(etage1);

var currentFloor; // étage actuellement affiché

function updateMarkersVisibility() {
    markersGroup.eachLayer(function(marker) {
        var markerFloor;
        if (marker.options && marker.options.floor !== undefined) {
            markerFloor = marker.options.floor;
        } else if (marker.feature && marker.feature.properties && marker.feature.properties.floor !== undefined) {
            markerFloor = marker.feature.properties.floor;
        }
        
        if (markerFloor !== undefined && markerFloor === currentFloor) {
            if (!map.hasLayer(marker)) {
                marker.addTo(map);
            }
        } else {
            if (map.hasLayer(marker)) {
                map.removeLayer(marker);
            }
        }
    });
}

function showFloor(floor, layer) {
    // Met à jour l'étage global
    currentFloor = floor;
    // Retire tous les calques d'étage
    [etage0, etage1, etage2].forEach(function(l) {
        if (map.hasLayer(l)) {
            map.removeLayer(l);
        }
    });
    // Affiche le calque correspondant à l'étage demandé
    map.addLayer(layer);
    // Met à jour la visibilité des marqueurs
    updateMarkersVisibility();
}

// Supposons que etage0, etage1, etage2 soient déjà définis.

// Fonction pour afficher un étage en retirant les autres
function showFloor(floor) {
  [etage0, etage1, etage2].forEach(function(layer) {
    if (map.hasLayer(layer)) {
      map.removeLayer(layer);
    }
  });
  map.addLayer(floor);
}

// Tableau contenant les étages dans l'ordre souhaité
var floors = [etage0, etage1, etage2];
var delayBetween = 1; // délai en millisecondes (ajustable)

floors.forEach(function(floor, index) {
  setTimeout(function() {
    showFloor(floor);
  }, index * delayBetween);
});

// Définir l'étage par défaut (ici "0") et mettre à jour la visibilité des marqueurs
currentFloor = "0";
updateMarkersVisibility();

  </script>
</body>
</html>